buildscript{
    ext.kotlin_version = "1.2.51"
    
    repositories{
        jcenter()
        mavenCentral()
        
        maven{
            url = "http://files.minecraftforge.net/maven"
        }
    }
    
    dependencies{
        classpath "net.minecraftforge.gradle:ForgeGradle:2.3-SNAPSHOT"
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:${kotlin_version}"
    }
}

apply plugin: "net.minecraftforge.gradle.forge"
apply plugin: "kotlin"

sourceCompatibility = targetCompatibility = "1.8"

tasks.withType(JavaCompile){
    sourceCompatibility = targetCompatibility = "1.8"
}

tasks.withType(org.jetbrains.kotlin.gradle.tasks.KotlinCompile){
    kotlinOptions{
        jvmTarget = "1.8"
        apiVersion = "1.2"
        languageVersion = "1.2"
    }
}

minecraft{
    version = "1.12.2-14.23.1.2606"
    runDir = "run"
    mappings = "snapshot_20180129"
    makeObfSourceJar = false
}

dependencies{
    compile "org.jetbrains.kotlin:kotlin-stdlib-jdk8"
    compile "org.jetbrains.kotlin:kotlin-reflect"

    testCompile "org.junit.jupiter:junit-jupiter-api:5.3.0-RC1"
}

test{
    systemProperty "junit.jupiter.testinstance.lifecycle.default", "per_class"
}

def modinfo = null

processResources{
    File file = new File(++sourceSets.main.resources.srcDirs.iterator(), "mcmod.info")
    modinfo = new groovy.json.JsonSlurper().parseText(file.getText())[0]
}

jar{
    archiveName = "HardcoreEnderExpansion  MC-${project.minecraft.version}  v${modinfo.version}.jar"
}
